#!MANAGED-CONFIG https://gist.githubusercontent.com/x/x/raw/x.yaml
#################### START ####################
mode: 'rule' # è¿è¡Œæ¨¡å¼ rule/global/direct, æš‚ä¸æ”¯æŒ script
log-level: 'debug' # æ—¥å¿—çº§åˆ« silent/error/warning/info/debug
find-process-mode: 'off' # è¿›ç¨‹æ¨¡å¼ off/strict/always
geodata-mode: false # GEOIP æ•°æ®æ¨¡å¼ geoip æ–‡ä»¶ä¸º mmdb/dat æ ¼å¼, true ä¸º dat æ ¼å¼

ipv6: true # IPv6 æ˜¯å¦å…è®¸å†…æ ¸æ¥å— IPv6 æµé‡
tcp-concurrent: true # TCP å¹¶å‘ å¦‚æœåŸŸåè§£æç»“æœå¯¹åº”å¤šä¸ªIP, å¹¶å‘è¯·æ±‚æ‰€æœ‰IP, é€‰æ‹©æ¡æ‰‹æœ€å¿«çš„IPè¿›è¡Œé€šè®¯
keep-alive-interval: 20 # æ§åˆ¶ Clash å‘å‡º TCP Keep Alive åŒ…çš„é—´éš”, å•ä½ s, å‡å°‘ç§»åŠ¨è®¾å¤‡è€—ç”µé—®é¢˜çš„ä¸´æ—¶æªæ–½
unified-delay: true # ç»Ÿä¸€å»¶è¿Ÿ, ä¼šè®¡ç®— RTT, ä»¥æ¶ˆé™¤è¿æ¥æ¡æ‰‹ç­‰å¸¦æ¥çš„ä¸åŒç±»å‹èŠ‚ç‚¹çš„å»¶è¿Ÿå·®å¼‚
global-client-fingerprint: 'chrome' # å…¨å±€å®¢æˆ·ç«¯æŒ‡çº¹ chrome/firefox/safari/iOS/android/edge/360/qq/random, ä¼˜å…ˆä½äº proxy å†…çš„ client-fingerprint, ç›®å‰æ”¯æŒå¼€å¯ TLS ä¼ è¾“çš„ TCP/grpc/WS/HTTP, æ”¯æŒåè®®æœ‰ VLESS/Vmess/Trojan
global-ua: 'Mozilla' # å…¨å±€ UA, é»˜è®¤ clash.meta

allow-lan: true # å…è®¸å…¶ä»–è®¾å¤‡ç»è¿‡ Clash çš„ä»£ç†ç«¯å£è®¿é—®äº’è”ç½‘
bind-address: '*' # ç»‘å®šåœ°å€, ä»…å…è®¸å…¶ä»–è®¾å¤‡é€šè¿‡è¿™ä¸ªåœ°å€è®¿é—®
authentication: # ç”¨æˆ·éªŒè¯ http(s)/socks/mixed ä»£ç†çš„ç”¨æˆ·éªŒè¯
  - 'clash:clash' # ç”¨æˆ·:å¯†ç 
skip-auth-prefixes: # è·³è¿‡éªŒè¯çš„ IP æ®µ
  - '127.0.0.1/8'
  - '::1/128'

profile: # ç¼“å­˜
  store-selected: true # å‚¨å­˜ API å¯¹ç­–ç•¥ç»„çš„é€‰æ‹©, ä»¥ä¾›ä¸‹æ¬¡å¯åŠ¨æ—¶ä½¿ç”¨

external-ui: './ui' # å¤–éƒ¨ç”¨æˆ·ç•Œé¢çš„è·¯å¾„ '/'ä»£è¡¨æ ¹ç›®å½• './'ä»£è¡¨å½“å‰ç›®å½•,'../'ä»£è¡¨ä¸Šçº§ç›®å½•
external-ui-url: 'https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip' # è‡ªå®šä¹‰å¤–éƒ¨ç”¨æˆ·ç•Œé¢ä¸‹è½½åœ°å€
external-controller: '0.0.0.0:9090' # API ç›‘å¬åœ°å€
secret: 'clash' # API çš„è®¿é—®å¯†é’¥



port: 5551 # http/socks/mixed ç«¯å£éªŒè¯ä¸å¤–éƒ¨è®¿é—®
socks-port: 5552 # socks4/4a/5 ä»£ç†ç«¯å£
redir-port: 5553 # redirect é€æ˜ä»£ç†ç«¯å£, ä»…èƒ½ä»£ç† TCP æµé‡
tproxy-port: 5554 # tproxy é€æ˜ä»£ç†ç«¯å£, å¯ä»£ç† TCP ä¸ UDP æµé‡
mixed-port: 5555 # æ··åˆç«¯å£ åŒæ—¶æ”¯æŒ HTTP(S) å’Œ SOCKS5 åè®®

tun:
  enable: true # æ˜¯å¦å¯ç”¨
  stack: 'mixed' # tun æ¨¡å¼å †æ ˆ system/gvisor/mixed
  device: 'Clash' # æŒ‡å®š tun ç½‘å¡åç§°, MacOS è®¾å¤‡åªèƒ½ä½¿ç”¨ utun å¼€å¤´çš„ç½‘å¡å
  auto-route: true # è‡ªåŠ¨è®¾ç½®å…¨å±€è·¯ç”±, å¯ä»¥è‡ªåŠ¨å°†å…¨å±€æµé‡è·¯ç”±è¿›å…¥ tun ç½‘å¡
  auto-redirect: false # è‡ªåŠ¨é…ç½® iptables/nftables ä»¥é‡å®šå‘ TCP è¿æ¥, éœ€è¦ auto-route å¯ç”¨
  auto-detect-interface: true # è‡ªåŠ¨é€‰æ‹©æµé‡å‡ºå£æ¥å£, å¤šå‡ºå£ç½‘å¡åŒæ—¶è¿æ¥çš„è®¾å¤‡å»ºè®®æ‰‹åŠ¨æŒ‡å®šå‡ºå£ç½‘å¡
  strict-route: false # ä¸¥æ ¼è·¯ç”± æ‰€æœ‰è¿æ¥è·¯ç”±åˆ° tun æ¥é˜²æ­¢æ³„æ¼, ä½†è®¾å¤‡å°†æ— æ³•è¢«å…¶ä»–è®¾å¤‡è®¿é—®
  udp-timeout: 180 # UDP NAT è¿‡æœŸæ—¶é—´, å•ä½ s, é»˜è®¤ä¸º 300(5 åˆ†é’Ÿ)
  endpoint-independent-nat: false # å¯ç”¨ç‹¬ç«‹äºç«¯ç‚¹çš„ NAT, æ€§èƒ½å¯èƒ½ä¼šç•¥æœ‰ä¸‹é™, æ‰€ä»¥ä¸å»ºè®®åœ¨ä¸éœ€è¦çš„æ—¶å€™å¼€å¯
  route-address: # å¯ç”¨ auto-route æ—¶ä½¿ç”¨è‡ªå®šä¹‰è·¯ç”±è€Œä¸æ˜¯é»˜è®¤è·¯ç”±
    - '0.0.0.0/1'
    - '128.0.0.0/1'
    - '::/1'
    - '8000::/1'
  route-exclude-address: # å¯ç”¨ auto-route æ—¶æ’é™¤è‡ªå®šä¹‰ç½‘æ®µ
    - '192.168.0.0/16'
    - 'fc00::/7'



hosts: # æ”¯æŒå•åŸŸåå¤š ip, æ ¼å¼ä¸ºæ•°ç»„; æ”¯æŒåŸŸåé€šé…ç¬¦(ä½¿ç”¨é€šé…ç¬¦çš„åŸŸåéƒ½åº”è¯¥ (') åŒ…è£¹, ä¾‹å¦‚, '*.google.com'), ä¸ä½¿ç”¨é€šé…ç¬¦çš„åŸŸåä¼˜å…ˆçº§é«˜äºä½¿ç”¨é€šé…ç¬¦çš„åŸŸå
  cloudflare-dns.com: [1.0.0.1, 2606:4700:4700::1001] # æŠŠåŸŸåç±»å‹ DNS åŠ å…¥ hosts ä»¥é˜²æ­¢ default-nameserver è§£ææ±¡æŸ“
  dns.alidns.com: [223.6.6.6, 2400:3200:baba::1]

dns: # DNS æœåŠ¡å™¨ä¹¦å†™è§„èŒƒåº”å¸¦å¼•å·, ä»¥é˜²å‡ºç°ç‰¹æ®Šå­—ç¬¦
  enable: true # æ˜¯å¦å¯ç”¨, å¦‚ä¸º false, åˆ™ä½¿ç”¨ç³»ç»Ÿ DNS è§£æ
  listen: '0.0.0.0:1053' # å¼€å¯ DNS æœåŠ¡å™¨ç›‘å¬
  ipv6: true # false å°†è¿”å› AAAA çš„ç©ºç»“æœ
  ipv6-timeout: 300 # å•ä½ ms, å†…éƒ¨åŒæ ˆå¹¶å‘, å‘ä¸Šæ¸¸æŸ¥è¯¢ AAAA æ—¶, ç­‰å¾… AAAA çš„æ—¶é—´, é»˜è®¤ 100
  prefer-h3: true # å¼€å¯ DoH æ”¯æŒ HTTP/3, å°†å¹¶å‘å°è¯•
  use-hosts: true # æ˜¯å¦æŸ¥è¯¢é…ç½®ä¸­çš„ hosts, é»˜è®¤ true
  use-system-hosts: false # æ˜¯å¦æŸ¥è¯¢ç³»ç»Ÿ hosts, é»˜è®¤ true
  respect-rules: false # dns è¿æ¥è·Ÿéš rule, éœ€é…ç½® proxy-server-nameserver
  enhanced-mode: 'redir-host' # DNS å¤„ç†æ¨¡å¼ fake-ip/redir-host(Meta å›æ»šäº† Redir Host éƒ¨åˆ†ä»£ç , ä»ç„¶ä¿ç•™ Clash v1.70 ä»¥å‰çš„ Redir Host æ¨¡å¼çš„åŸŸåä¼ é€’è¡Œä¸º)/normal
  nameserver: # é»˜è®¤åŸŸåè§£æ, å¦‚ä¸é…ç½® fallback/proxy-server-nameserver, åˆ™éƒ½ç”± nameserver è§£æ
    - 'https://cloudflare-dns.com/dns-query#Proxy' # Cloudflare DNS
  proxy-server-nameserver: # ç”¨äºèŠ‚ç‚¹åŸŸåè§£æ å¦‚å…¶ä»– DNS éœ€è¿‡ä»£ç†æŸ¥è¯¢/nameserver ä¸ºå›½å¤– DNS åˆ™é…ç½®è¯¥é¡¹ä»¥é˜²å‡ºç°é¸¡è›‹é—®é¢˜
    - 'https://dns.alidns.com/dns-query' # Alibaba DNS
  nameserver-policy: # æŒ‡å®šçš„è§£ææœåŠ¡, æ²¡åŒ¹é…åˆ°ä½¿ç”¨ nameserver/fallback å¹¶å‘æŸ¥è¯¢
    'rule-set:site_geolocation-!cn': # å› ä¸º cn é‡ŒåŒ…å«äº† geolocation-!cn çš„åŸŸå æ‰€ä»¥æŠŠå®ƒæ”¾å‰é¢
      - 'https://cloudflare-dns.com/dns-query#Proxy'
    'rule-set:site_private,site_cn':
      - 'https://dns.alidns.com/dns-query#Direct'

sniffer: # Sniffer åŸŸåå—…å™¨ é€šè¿‡è¯»å–æ¡æ‰‹åŒ…å†…çš„åŸŸåå­—æ®µ, å°† IP è¿˜åŸæˆåŸŸå
  enable: true # æ˜¯å¦å¯ç”¨
  force-dns-mapping: true # å¯¹ redir-host ç±»å‹è¯†åˆ«çš„æµé‡è¿›è¡Œå¼ºåˆ¶å—…æ¢
  parse-pure-ip: true # å¯¹æ‰€æœ‰æœªè·å–åˆ°åŸŸåçš„æµé‡è¿›è¡Œå¼ºåˆ¶å—…æ¢
  override-destination: true # æ˜¯å¦ä½¿ç”¨å—…æ¢ç»“æœä½œä¸ºå®é™…è®¿é—®, é»˜è®¤  true
  sniff: # TLS å’Œ QUIC é»˜è®¤å¦‚æœä¸é…ç½® ports é»˜è®¤å—…æ¢ 443
    HTTP: # é»˜è®¤å—…æ¢ 80
      ports: [80, 443, 8080-8880]
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  skip-domain: # éœ€è¦è·³è¿‡å—…æ¢çš„åŸŸå, ä¸»è¦è§£å†³éƒ¨åˆ†ç«™ç‚¹ sni å­—æ®µéåŸŸå, å¯¼è‡´å—…æ¢ç»“æœå¼‚å¸¸çš„é—®é¢˜, å¦‚ç±³å®¶è®¾å¤‡
    - '+.push.apple.com'
    - 'Mijia Cloud'
    - 'dlg.io.mi.com'
    - '+.jd.com'
    - '+.taobao.com'
    - '+.tmall.com'
    - '*.rc.sunlogin.net'



ntp: # NTP æœåŠ¡å™¨é…ç½® å¦‚æœä½¿ç”¨ Vmess åè®®, å®¢æˆ·ç«¯å’Œ VPS çš„æ—¶é—´è¯¯å·®è¶… 90s, å°±ä¼šå¯¼è‡´ä¸èƒ½æ­£å¸¸ä½¿ç”¨(å’Œæ—¶åŒºæ— å…³)
  enable: false # æ˜¯å¦å¯ç”¨ NTP æœåŠ¡
  write-to-system: true # æ˜¯å¦åŒæ­¥è‡³ç³»ç»Ÿæ—¶é—´, éœ€è¦ root/ç®¡ç†å‘˜æ¨¡å¼ è¿è¡Œ
  server: 'ntp.ntsc.ac.cn' # NTP æœåŠ¡åœ°å€
  port: 123 # NTP æœåŠ¡ç«¯å£, é»˜è®¤ 123
  interval: 1440 # åŒæ­¥æ—¶é—´é—´éš”, å•ä½ min, é»˜è®¤ 30 min

proxies: # å‡ºç«™é…ç½® æŸ¥çœ‹æ¥å£å‘½ä»¤: netsh interface show interface  Tip: æ‰‹æœºéœ€è¦ root è·‘å†…æ ¸ ä»¥ç»‘å®šæ¥å£
  - {name: 'dns-hijacking', type: dns, udp: true} # dns å‡ºç«™ä¼šå°†è¯·æ±‚åŠ«æŒåˆ°å†…éƒ¨ dns æ¨¡å—, æ‰€æœ‰è¯·æ±‚å‡åœ¨å†…éƒ¨å¤„ç†
  - {name: 'ğ– ğ—ğ—ğ—ˆ', type: direct, udp: true}
  - {name: 'ä»¥å¤ªç½‘', type: direct, udp: true, interface-name: 'ä»¥å¤ªç½‘'} # Windows ç½‘çº¿
  - {name: 'WLAN', type: direct, udp: true, interface-name: 'WLAN'} # Windows WiFi
  - {name: 'wlan0', type: direct, udp: true, interface-name: 'wlan0'} # WiFi/Wå£
  - {name: 'wlan1', type: direct, udp: true, interface-name: 'wlan1'}
  - {name: 'rmnet_data0', type: direct, udp: true, interface-name: 'rmnet_data0'} # Android ç§»åŠ¨æ•°æ®
  - {name: 'rmnet_data1', type: direct, udp: true, interface-name: 'rmnet_data1'}
  - {name: 'rmnet_data2', type: direct, udp: true, interface-name: 'rmnet_data2'}
  - {name: 'rmnet_data3', type: direct, udp: true, interface-name: 'rmnet_data3'}

proxy-providers-anchor: # é”šç‚¹ å¦‚åˆå¹¶æ—¶æœ‰é‡å¤çš„é¡¹, åˆ™ä¸ä¼šå»åˆå¹¶; é”šç‚¹åä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦
  - health_check: &health_check {health-check: {enable: true, expected-status: 204, url: 'https://www.google.com/generate_204', timeout: 3500, interval: 6}} # å»¶è¿Ÿæ£€æµ‹
  - header: &header {header: {User-Agent: ['clash.meta', 'meta', 'mihomo', 'clash-verge', 'ClashMetaForAndroid', 'flclash', 'stash', 'ClashforWindows', 'ClashForAndroid', 'clash']}} # UA
  - update: &update {proxy: Provider, interval: 86400} # æ›´æ–° provider ä½¿ç”¨çš„èŠ‚ç‚¹æˆ–ç­–ç•¥ç»„/æ›´æ–° provider çš„é—´éš”, å•ä½ s  Tip: è®¾ç½®çš„è¿‡äºå°å¯èƒ½è¢«æœºåœº ban
  - filter_exclude_Ad: &filter_exclude_Ad {filter: '^(?=.*(.))(?!.*((?i)ç¾¤|é‚€è¯·|è¿”åˆ©|å¾ªç¯|å®˜ç½‘|å®¢æœ|ç½‘ç«™|ç½‘å€|è·å–|è®¢é˜…|æµé‡|åˆ°æœŸ|æœºåœº|ä¸‹æ¬¡|ç‰ˆæœ¬|å®˜å€|å¤‡ç”¨|è¿‡æœŸ|å·²ç”¨|è”ç³»|é‚®ç®±|å·¥å•|è´©å–|é€šçŸ¥|å¯¼èˆª|å€’å–|é˜²æ­¢|å›½å†…|åœ°å€|é¢‘é“|æ— æ³•|è¯´æ˜|ä½¿ç”¨|æç¤º|ç‰¹åˆ«|è®¿é—®|æ”¯æŒ|æ•™ç¨‹|å…³æ³¨|æ›´æ–°|ä½œè€…|åŠ å…¥|(\b(USE|USED|TG|TOTAL|EXPIRE|EMAIL|Panel|Channel|Author)\b|(\d{4}-\d{2}-\d{2}|\d+G)))).*$'} # å¼•å…¥ç­›é€‰/æ’é™¤, ä½¿ç”¨ç­›é€‰å¯èƒ½ä¼šåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¢åŠ CPUå ç”¨/è½¬å‘å»¶è¿Ÿ, å°¤å…¶æ˜¯ä½¿ç”¨è¾ƒä¸ºå¤æ‚æ­£åˆ™çš„æƒ…å†µä¸‹
  - override: &override {ip-version: 'ipv4-prefer'} # è¦†å†™

proxy-providers: # æ”¯æŒç›´æ¥ä½¿ç”¨ V2rayN ç­‰å®¢æˆ·ç«¯çš„æ™®é€šè®¢é˜…; ä¸€ä¸ªåˆæ³•çš„è¿œç¨‹ä»£ç†é›†å¿…é¡»åŒ…å« proxies å­—æ®µ, è¿œç¨‹ä»£ç†é›†ä¸ºç©ºæ—¶ä¼šä»¥ DIRECT æ›¿ä»£
  Provider_1: # Free Cloud aff: https://intel.im/#/register?code=YDEx84ta
    type: http # å¿…é¡», provider ç±»å‹ http/file
    url: '' # æ­¤è¡Œå•å¼•å·å†…å¡«å…¥ä½ çš„è®¢é˜…é“¾æ¥
    <<: [*health_check, *header, *update, *filter_exclude_Ad]
    override:
      <<: *override
      additional-suffix: '@ProvÂ¹' # ä¸ºèŠ‚ç‚¹åç§°æ·»åŠ å›ºå®šåç¼€
    path: './proxy_providers/Provider_1.yaml' # é…ç½®ä¿å­˜ä½ç½® '/'ä»£è¡¨æ ¹ç›®å½• './'ä»£è¡¨å½“å‰ç›®å½•,'../'ä»£è¡¨ä¸Šçº§ç›®å½•

  Provider_2: # Free Cloud aff: https://intel.im/#/register?code=YDEx84ta
    type: http
    url: '' # æ­¤è¡Œå•å¼•å·å†…å¡«å…¥ä½ çš„è®¢é˜…é“¾æ¥
    <<: [*health_check, *header, *update, *filter_exclude_Ad]
    override:
      <<: *override
      additional-suffix: '@ProvÂ²' # ä¸ºèŠ‚ç‚¹åç§°æ·»åŠ å›ºå®šåç¼€
    path: './proxy_providers/Provider_2.yaml' # é…ç½®ä¿å­˜ä½ç½® '/'ä»£è¡¨æ ¹ç›®å½• './'ä»£è¡¨å½“å‰ç›®å½•,'../'ä»£è¡¨ä¸Šçº§ç›®å½•

  Provider_3: # Free Cloud aff: https://intel.im/#/register?code=YDEx84ta
    type: http
    url: '' # æ­¤è¡Œå•å¼•å·å†…å¡«å…¥ä½ çš„è®¢é˜…é“¾æ¥
    path: './proxy_providers/Provider_3.yaml' # é…ç½®ä¿å­˜ä½ç½® '/'ä»£è¡¨æ ¹ç›®å½• './'ä»£è¡¨å½“å‰ç›®å½•,'../'ä»£è¡¨ä¸Šçº§ç›®å½•
    <<: [*health_check, *header, *update, *filter_exclude_Ad]
    override:
      <<: *override
      additional-suffix: '@ProvÂ³' # ä¸ºèŠ‚ç‚¹åç§°æ·»åŠ å›ºå®šåç¼€

  Provider_4: # Free Cloud aff: https://intel.im/#/register?code=YDEx84ta
    type: http
    url: '' # æ­¤è¡Œå•å¼•å·å†…å¡«å…¥ä½ çš„è®¢é˜…é“¾æ¥
    <<: [*health_check, *header, *update, *filter_exclude_Ad]
    override:
      <<: *override
      additional-suffix: '@Provâ´' # ä¸ºèŠ‚ç‚¹åç§°æ·»åŠ å›ºå®šåç¼€
    path: './proxy_providers/Provider_4.yaml' # é…ç½®ä¿å­˜ä½ç½® '/'ä»£è¡¨æ ¹ç›®å½• './'ä»£è¡¨å½“å‰ç›®å½•,'../'ä»£è¡¨ä¸Šçº§ç›®å½•  



proxy-groups-anchor: # é”šç‚¹ å¦‚åˆå¹¶æ—¶æœ‰é‡å¤çš„é¡¹, åˆ™ä¸ä¼šå»åˆå¹¶; é”šç‚¹åä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦
  - filter_exclude_Back: &filter_exclude_Back {filter: '^(?!.*((?i)å›å›½|æ ¡å›­)).*$'} # æ’é™¤å›å›½
  - filter_HK: &filter_HK {filter: '^(?=.*((?i)ğŸ‡­ğŸ‡°|é¦™æ¸¯|(\b(HK|Hong)\b))).*$'}
  - filter_JP: &filter_JP {filter: '^(?=.*((?i)ğŸ‡¯ğŸ‡µ|æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|(\b(JP|Japan)\b))).*$'}
  - filter_SG: &filter_SG {filter: '^(?=.*((?i)ğŸ‡¸ğŸ‡¬|æ–°åŠ å¡|ç‹®|(\b(SG|Singapore)\b))).*$'}
  - filter_US: &filter_US {filter: '^(?=.*((?i)ğŸ‡ºğŸ‡¸|ç¾å›½|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|(\b(US|United States)\b))).*$'}

  - proxies_P: &proxies_P {proxies: [Proxy, Direct, ProvÂ¹, ProvÂ², ProvÂ³, Provâ´]}
  - proxies_D: &proxies_D {proxies: [Direct, Proxy, ProvÂ¹, ProvÂ², ProvÂ³, Provâ´]}

  - url_test: &url_test {type: url-test, expected-status: 204, url: 'https://www.google.com/generate_204', timeout: 3500, max-failed-times: 2, interval: 6, tolerance: 15}

  - fall_back: &fall_back {type: fallback, expected-status: 204, url: 'https://www.google.com/generate_204', timeout: 3500, max-failed-times: 2, interval: 6}
  - fall_back_Netflix: &fall_back_Netflix {type: fallback, expected-status: 204, url: 'https://www.netflix.com', timeout: 3500, max-failed-times: 2, interval: 6}

  - rrobin: &rrobin {type: load-balance, strategy: round-robin, expected-status: 204, url: 'https://www.google.com/generate_204', timeout: 3500, max-failed-times: 2, interval: 6}

proxy-groups: # ç­–ç•¥ç»„å¯ä»¥åŒ…å«å¤šä¸ªä»£ç†, æˆ–å¤šä¸ªè¿œç¨‹ä»£ç†é›†; ä¸åŒ…å«ä»»ä½•ä»£ç†çš„ç­–ç•¥ç»„, ä¼šè¢«å½“ä½œä¸º DIRECT ç­–ç•¥å¤„ç†; å¦‚ç­–ç•¥ç»„ä»£ç†æ¥è‡ªè¿œç¨‹ä»£ç†é›†æ—¶, åˆ™ä½¿ç”¨è¯¥æ¥æºçš„ health-check
  - {name: 'AutoÂ¹', <<: [*url_test, *filter_exclude_Back], use: [Provider_1], hidden: true}
  - {name: 'FallbackÂ¹', <<: [*fall_back, *filter_exclude_Back], use: [Provider_1], hidden: true}
  - {name: 'AutoÂ²', <<: [*url_test, *filter_exclude_Back], use: [Provider_2], hidden: true}
  - {name: 'FallbackÂ²', <<: [*fall_back, *filter_exclude_Back], use: [Provider_2], hidden: true}
  - {name: 'AutoÂ³', <<: [*url_test, *filter_exclude_Back], use: [Provider_3], hidden: true}
  - {name: 'FallbackÂ³', <<: [*fall_back, *filter_exclude_Back], use: [Provider_3], hidden: true}
  - {name: 'Autoâ´', <<: [*url_test, *filter_exclude_Back], use: [Provider_4], hidden: true}
  - {name: 'Fallbackâ´', <<: [*fall_back, *filter_exclude_Back], use: [Provider_4], hidden: true}

  - {name: 'HK autoÂ¹', <<: [*url_test, *filter_HK], use: [Provider_1], hidden: true}
  - {name: 'HK autoÂ²', <<: [*url_test, *filter_HK], use: [Provider_2], hidden: true}
  - {name: 'HK autoÂ³', <<: [*url_test, *filter_HK], use: [Provider_3], hidden: true}
  - {name: 'HK autoâ´', <<: [*url_test, *filter_HK], use: [Provider_4], hidden: true}

  - {name: 'JP autoÂ¹', <<: [*url_test, *filter_JP], use: [Provider_1], hidden: true}
  - {name: 'JP autoÂ²', <<: [*url_test, *filter_JP], use: [Provider_2], hidden: true}
  - {name: 'JP autoÂ³', <<: [*url_test, *filter_JP], use: [Provider_3], hidden: true}
  - {name: 'JP autoâ´', <<: [*url_test, *filter_JP], use: [Provider_4], hidden: true}

  - {name: 'SG autoÂ¹', <<: [*url_test, *filter_SG], use: [Provider_1], hidden: true}
  - {name: 'SG autoÂ²', <<: [*url_test, *filter_SG], use: [Provider_2], hidden: true}
  - {name: 'SG autoÂ³', <<: [*url_test, *filter_SG], use: [Provider_3], hidden: true}
  - {name: 'SG autoâ´', <<: [*url_test, *filter_SG], use: [Provider_4], hidden: true}

  - {name: 'US autoÂ¹', <<: [*url_test, *filter_US], use: [Provider_1], hidden: true}
  - {name: 'US autoÂ²', <<: [*url_test, *filter_US], use: [Provider_2], hidden: true}
  - {name: 'US autoÂ³', <<: [*url_test, *filter_US], use: [Provider_3], hidden: true}
  - {name: 'US autoâ´', <<: [*url_test, *filter_US], use: [Provider_4], hidden: true}

  - {name: 'HK rrobinÂ¹', <<: [*rrobin, *filter_HK], use: [Provider_1], hidden: true}
  - {name: 'HK rrobinÂ²', <<: [*rrobin, *filter_HK], use: [Provider_2], hidden: true}
  - {name: 'HK rrobinÂ³', <<: [*rrobin, *filter_HK], use: [Provider_3], hidden: true}
  - {name: 'HK rrobinâ´', <<: [*rrobin, *filter_HK], use: [Provider_4], hidden: true}
 
  - {name: 'JP rrobinÂ¹', <<: [*rrobin, *filter_JP], use: [Provider_1], hidden: true}
  - {name: 'JP rrobinÂ²', <<: [*rrobin, *filter_JP], use: [Provider_2], hidden: true}
  - {name: 'JP rrobinÂ³', <<: [*rrobin, *filter_JP], use: [Provider_3], hidden: true}
  - {name: 'JP rrobinâ´', <<: [*rrobin, *filter_JP], use: [Provider_4], hidden: true}

  - {name: 'SG rrobinÂ¹', <<: [*rrobin, *filter_SG], use: [Provider_1], hidden: true}
  - {name: 'SG rrobinÂ²', <<: [*rrobin, *filter_SG], use: [Provider_2], hidden: true}
  - {name: 'SG rrobinÂ³', <<: [*rrobin, *filter_SG], use: [Provider_3], hidden: true}
  - {name: 'SG rrobinâ´', <<: [*rrobin, *filter_SG], use: [Provider_4], hidden: true}

  - {name: 'US rrobinÂ¹', <<: [*rrobin, *filter_US], use: [Provider_1], hidden: true}
  - {name: 'US rrobinÂ²', <<: [*rrobin, *filter_US], use: [Provider_2], hidden: true}
  - {name: 'US rrobinÂ³', <<: [*rrobin, *filter_US], use: [Provider_3], hidden: true}
  - {name: 'US rrobinâ´', <<: [*rrobin, *filter_US], use: [Provider_4], hidden: true}

  - {name: 'ä»¥å¤ªç½‘ + WLAN', <<: *rrobin, proxies: [ä»¥å¤ªç½‘, WLAN], hidden: true}
  - {name: 'wlan0 + wlan1', <<: *rrobin, proxies: [wlan0, wlan1], hidden: true}
  - {name: 'data0 + wlan0', <<: *rrobin, proxies: [rmnet_data0, wlan0], hidden: true}
  - {name: 'data0 + wlan1', <<: *rrobin, proxies: [rmnet_data0, wlan1], hidden: true}
  - {name: 'data1 + wlan0', <<: *rrobin, proxies: [rmnet_data1, wlan0], hidden: true}
  - {name: 'data1 + wlan1', <<: *rrobin, proxies: [rmnet_data1, wlan1], hidden: true}
  - {name: 'data2 + wlan0', <<: *rrobin, proxies: [rmnet_data2, wlan0], hidden: true}
  - {name: 'data2 + wlan1', <<: *rrobin, proxies: [rmnet_data2, wlan1], hidden: true}
  - {name: 'data3 + wlan0', <<: *rrobin, proxies: [rmnet_data3, wlan0], hidden: true}
  - {name: 'data3 + wlan1', <<: *rrobin, proxies: [rmnet_data3, wlan1], hidden: true}

  - {name: 'Auto', <<: [*url_test, *filter_exclude_Back], include-all-providers: true, hidden: true}
  - {name: 'Fallback', <<: [*fall_back, *filter_exclude_Back], include-all-providers: true, hidden: true}

  - {name: 'Proxy', type: select, <<: [*url_test], proxies: [Auto, Fallback, Direct, ProvÂ¹, ProvÂ², ProvÂ³, Provâ´], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Final.png'}
  - {name: 'Direct', type: select, <<: [*url_test], proxies: [ğ– ğ—ğ—ğ—ˆ, ä»¥å¤ªç½‘ + WLAN, wlan0 + wlan1, data0 + wlan0, data0 + wlan1, data1 + wlan0, data1 + wlan1, data2 + wlan0, data2 + wlan1, data3 + wlan0, data3 + wlan1], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/China_Map.png'}
  - {name: 'Google', type: select, proxies: [Direct, Proxy, Fallback], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Google_Search.png'}
  - {name: 'TGram', type: select, <<: [*proxies_P], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Telegram.png'}
  - {name: 'Netflix', <<: [*fall_back_Netflix, *proxies_P], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Netflix.png'}
  - {name: 'Torrent', type: select, proxies: [Direct, Proxy], include-all-providers: true, filter: '(?i)(?:BT|PT|å¢æ£®å ¡)', icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Server.png'}
  - {name: 'Privacy', type: select, proxies: [REJECT-DROP, PASS, Proxy, Direct], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Hijacking.png'}
  - {name: 'Recreation', type: select, <<: [*proxies_D], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Game.png'}
  - {name: 'QUIC', type: select, proxies: [PASS, REJECT-DROP], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Proxy.png'}
  - {name: 'Provider', type: select, proxies: [Direct, Proxy], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Airport.png'} # ç”¨äºæ§åˆ¶é…ç½®èµ„æºæ›´æ–°çš„ç­–ç•¥ç»„

  - {name: 'ProvÂ¹', type: select, proxies: [AutoÂ¹, FallbackÂ¹, HK autoÂ¹, JP autoÂ¹, SG autoÂ¹, US autoÂ¹, HK rrobinÂ¹, JP rrobinÂ¹, SG rrobinÂ¹, US rrobinÂ¹], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Direct.png'}
  - {name: 'ProvÂ²', type: select, proxies: [AutoÂ², FallbackÂ², HK autoÂ², JP autoÂ², SG autoÂ², US autoÂ², HK rrobinÂ², JP rrobinÂ², SG rrobinÂ², US rrobinÂ²], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Direct.png'}
  - {name: 'ProvÂ³', type: select, proxies: [AutoÂ³, FallbackÂ³, HK autoÂ³, JP autoÂ³, SG autoÂ³, US autoÂ³, HK rrobinÂ³, JP rrobinÂ³, SG rrobinÂ³, US rrobinÂ³], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Direct.png'}
  - {name: 'Provâ´', type: select, proxies: [Autoâ´, Fallbackâ´, HK autoâ´, JP autoâ´, SG autoâ´, US autoâ´, HK rrobinâ´, JP rrobinâ´, SG rrobinâ´, US rrobinâ´], icon: 'https://cdn.jsdelivr.net/gh/Koolson/Qure@master/IconSet/Color/Direct.png'}



rule-providers-anchor: # é”šç‚¹ å¦‚åˆå¹¶æ—¶æœ‰é‡å¤çš„é¡¹, åˆ™ä¸ä¼šå»åˆå¹¶; é”šç‚¹åä¸èƒ½åŒ…å«ç‰¹æ®Šå­—ç¬¦
  rule_domain: &rule_domain {type: http, behavior: domain, format: mrs, proxy: Provider}
  rule_ipcidr: &rule_ipcidr {type: http, behavior: ipcidr, format: mrs, proxy: Provider}
  rule_classical: &rule_classical {type: http, behavior: classical, format: yaml, proxy: Provider}

rule-providers: # åˆ©ç”¨è§„åˆ™é›†åˆ, å¯ä»¥åœ¨è¾ƒä½èµ„æºå ç”¨æƒ…å†µä¸‹å¼•ç”¨å¤§é‡è§„åˆ™; domain/ipcidr ç±»è§„åˆ™é›†, æ¯” classical ç±»è§„åˆ™é›†åŒ¹é…æ›´é«˜æ•ˆ
  AdGuard_DNS_filter:
    <<: *rule_classical
    path: './rule_providers/classical/AdGuard_DNS_filter'
    url: 'https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/AdGuardSDNSFilter/AdGuardSDNSFilter_Classical.yaml'
  site_category-httpdns:
    <<: *rule_domain
    path: './rule_providers/domain/category-httpdns'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-httpdns.mrs'
  site_private:
    <<: *rule_domain
    path: './rule_providers/domain/private'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/private.mrs'
  site_googlefcm:
    <<: *rule_domain
    path: './rule_providers/domain/googlefcm'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/googlefcm.mrs'
  site_category-public-tracker:
    <<: *rule_domain
    path: './rule_providers/domain/category-public-tracker'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-public-tracker.mrs'
  site_category-pt:
    <<: *rule_domain
    path: './rule_providers/domain/category-pt'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-pt.mrs'
  site_category-games@cn:
    <<: *rule_domain
    path: './rule_providers/domain/category-games@cn'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/category-games@cn.mrs'
  site_netflix:
    <<: *rule_domain
    path: './rule_providers/domain/netflix'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/netflix.mrs'
  site_telegram:
    <<: *rule_domain
    path: './rule_providers/domain/telegram'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/telegram.mrs'
  site_google:
    <<: *rule_domain
    path: './rule_providers/domain/google'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/google.mrs'
  site_alibaba:
    <<: *rule_domain
    path: './rule_providers/domain/alibaba'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/alibaba.mrs'
  site_tencent:
    <<: *rule_domain
    path: './rule_providers/domain/tencent'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/tencent.mrs'
  site_geolocation-!cn:
    <<: *rule_domain
    path: './rule_providers/domain/geolocation-!cn'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/geolocation-!cn.mrs'
  site_cn:
    <<: *rule_domain
    path: './rule_providers/domain/cn'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geosite/cn.mrs'

  ip_private:
    <<: *rule_ipcidr
    path: './rule_providers/ipcidr/private'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/private.mrs'
  ip_telegram:
    <<: *rule_ipcidr
    path: './rule_providers/ipcidr/telegram'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/telegram.mrs'
  ip_netflix:
    <<: *rule_ipcidr
    path: './rule_providers/ipcidr/netflix'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/netflix.mrs'
  ip_cloudflare:
    <<: *rule_ipcidr
    path: './rule_providers/ipcidr/cloudflare'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cloudflare.mrs'
  ip_google:
    <<: *rule_ipcidr
    path: './rule_providers/ipcidr/google'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/google.mrs'
  ip_cn:
    <<: *rule_ipcidr
    path: './rule_providers/ipcidr/cn'
    url: 'https://cdn.jsdelivr.net/gh/MetaCubeX/meta-rules-dat@meta/geo/geoip/cn.mrs'

sub-rules: # å­è§„åˆ™ åŒ¹é…åˆ° sub-rules æ—¶, æœªå‘½ä¸­åˆ™ä½¿ç”¨ rules

rules: # åˆ†æµè§„åˆ™å¯ä»¥ç›´æ¥å¼•ç”¨ä»£ç†æˆ–ç­–ç•¥ç»„, ä½†ä¸èƒ½å¼•ç”¨è¿œç¨‹ä»£ç†é›†; å¯¹äºæ¯ä¸€æ¡è¿æ¥, æ€»æ˜¯ä»ä¸Šåˆ°ä¸‹åŒ¹é…è§„åˆ™; éœ€è¦å¤æ‚æ¡ä»¶æ—¶, å¯ä»¥ç”¨é€»è¾‘è¿ç®—ç¬¦å»ç»„åˆå¤šä¸ªè§„åˆ™. å¹¶ä¸”é€»è¾‘è§„åˆ™æ˜¯å¯ä»¥ç›¸äº’åµŒå¥—çš„
  - 'DST-PORT,53,dns-hijacking' # åŠ«æŒ DNS åˆ° Clash å†…éƒ¨ DNS æ¨¡å—
  - 'RULE-SET,AdGuard_DNS_filter,REJECT-DROP' # éœ€è¦æ‹¦æˆªçš„å¹¿å‘Š å¤§éƒ¨åˆ†æƒ…å†µå¯èƒ½å‡ºç°è¯¯æ€
  - 'AND,((NETWORK,udp),(DST-PORT,443),(NOT,((OR,(RULE-SET,site_cn),(RULE-SET,ip_cn))))),QUIC' # å›½å†…ä»¥å¤–çš„ QUIC
  - 'AND,((NETWORK,udp),(DST-PORT,443/19302/3478/5349/49152-65535),(OR,(DOMAIN-KEYWORD,stun),(DOMAIN-KEYWORD,turn))),Privacy' # æ˜¯å¦ç¦ç”¨ stun/turn åè®®çš„ udp æ•°æ®ï¼Œç¦ç”¨åå¯ä»¥æœ‰æ•ˆè§£å†³ webrtc çš„ ip æ³„éœ²
  - 'AND,((DST-PORT,5228-5230),(RULE-SET,site_googlefcm)),Google' # Google FCM ç›´è¿ç¡®ä¿ DNS æ— æ±¡æŸ“/åŠ«æŒ
  - 'OR,((RULE-SET,site_category-httpdns),(DOMAIN-KEYWORD,httpdns)),REJECT-DROP' # æ‹¦æˆª httpdns æœåŠ¡, ä»¥ç¡®ä¿è¿™äº›è¯·æ±‚èƒ½å¤Ÿåœ¨ Clash çš„ DNS æ¡†æ¶ä¸‹å·¥ä½œ
  - 'OR,((RULE-SET,site_private),(RULE-SET,ip_private,no-resolve)),Direct' # å±€åŸŸç½‘..
  - 'OR,((RULE-SET,site_category-public-tracker),(RULE-SET,site_category-pt)),Torrent' # ç§å­
  - 'OR,((RULE-SET,site_category-games@cn),(RULE-SET,site_category-games@cn)),Recreation' # æ¸¸æˆç›¸å…³éƒ¨åˆ† cn åŸŸå
  - 'OR,((RULE-SET,site_telegram),(RULE-SET,ip_telegram)),TGram' # ç”µæŠ¥
  - 'OR,((RULE-SET,site_netflix),(RULE-SET,ip_netflix)),Netflix' # å¥ˆé£ 
  - 'OR,((RULE-SET,site_google),(RULE-SET,ip_google)),Proxy' # è°·æ­Œ
  - 'OR,((RULE-SET,site_tencent),(IP-ASN,45090),(IP-ASN,132203)),Direct' # è…¾è®¯
  - 'OR,((RULE-SET,site_geolocation-!cn),(RULE-SET,ip_cloudflare)),Proxy' # å›½å¤–å¸¸è§åŸŸå/ip
  - 'OR,((RULE-SET,site_cn),(RULE-SET,ip_cn)),Direct' # éƒ¨åˆ† cn åŸŸå/ip 
  - 'MATCH,Proxy' # åŒ¹é…æ‰€æœ‰è¯·æ±‚, æ— éœ€æ¡ä»¶

#################### END ####################
